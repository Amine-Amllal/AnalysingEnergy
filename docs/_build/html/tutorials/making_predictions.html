

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Making Predictions Tutorial &mdash; AnalysingEnergy 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
      <script src="../_static/jquery.js"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
      <script src="../_static/doctools.js"></script>
      <script src="../_static/sphinx_highlight.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Preprocessing Notebook" href="../notebooks/data_preprocessing.html" />
    <link rel="prev" title="Model Training Tutorial" href="model_training.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AnalysingEnergy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_overview.html">Data Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_architecture.html">Model Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/interface.html">Interface API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/models.html">Models API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_preprocessing.html">Data Preprocessing Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_training.html">Model Training Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Making Predictions Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-1-environment-setup">Step 1: Environment Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-required-libraries">Import Required Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-data-and-configuration">Load Data and Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-load-trained-models-and-scalers">Step 2: Load Trained Models and Scalers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-main-model">Load Main Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-scalers">Load Scalers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-individual-feature-models">Load Individual Feature Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-single-step-prediction">Step 3: Single-Step Prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prepare-input-data">Prepare Input Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#make-single-predictions">Make Single Predictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluate-single-predictions">Evaluate Single Predictions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-multi-step-forecasting-365-days">Step 4: Multi-Step Forecasting (365 Days)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implement-future-prediction-function">Implement Future Prediction Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-future-dates">Create Future Dates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-ensemble-predictions-with-individual-models">Step 5: Ensemble Predictions with Individual Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#predict-individual-features-for-future">Predict Individual Features for Future</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ensemble-prediction">Ensemble Prediction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-6-prediction-confidence-intervals">Step 6: Prediction Confidence Intervals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculate-prediction-uncertainty">Calculate Prediction Uncertainty</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-7-visualization-and-analysis">Step 7: Visualization and Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plot-predictions">Plot Predictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#seasonal-analysis">Seasonal Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#feature-importance-analysis">Feature Importance Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-8-export-results">Step 8: Export Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#save-predictions">Save Predictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-prediction-report">Create Prediction Report</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices-for-predictions">Best Practices for Predictions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-maintenance">Model Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uncertainty-quantification">Uncertainty Quantification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#practical-applications">Practical Applications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/data_preprocessing.html">Data Preprocessing Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lstm_generation.html">LSTM Generation Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lstm_complete.html">LSTM Complete Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/predicting_365_days.html">Predicting Next 365 Days Notebook</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to AnalysingEnergy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AnalysingEnergy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Making Predictions Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/making_predictions.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="making-predictions-tutorial">
<h1>Making Predictions Tutorial<a class="headerlink" href="#making-predictions-tutorial" title="Permalink to this heading"></a></h1>
<p>This tutorial demonstrates how to use the trained LSTM models to make predictions for energy generation and related parameters in the AnalysingEnergy project.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>This tutorial covers:</p>
<ol class="arabic simple">
<li><p>Loading trained models and scalers</p></li>
<li><p>Single-step prediction</p></li>
<li><p>Multi-step forecasting (365 days)</p></li>
<li><p>Ensemble predictions using multiple models</p></li>
<li><p>Prediction confidence intervals</p></li>
<li><p>Visualization and interpretation</p></li>
<li><p>Exporting results</p></li>
</ol>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h2>
<p>Complete the <a class="reference internal" href="model_training.html"><span class="doc">Model Training Tutorial</span></a> tutorial and ensure you have:</p>
<ul class="simple">
<li><p>Trained LSTM models saved in <code class="docutils literal notranslate"><span class="pre">models/</span></code> directory</p></li>
<li><p>Fitted scalers saved in <code class="docutils literal notranslate"><span class="pre">scalers/</span></code> directory</p></li>
<li><p>Test data available for validation</p></li>
</ul>
</section>
<section id="step-1-environment-setup">
<h2>Step 1: Environment Setup<a class="headerlink" href="#step-1-environment-setup" title="Permalink to this heading"></a></h2>
<section id="import-required-libraries">
<h3>Import Required Libraries<a class="headerlink" href="#import-required-libraries" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># TensorFlow imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Set style for plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;husl&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TensorFlow version: </span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="load-data-and-configuration">
<h3>Load Data and Configuration<a class="headerlink" href="#load-data-and-configuration" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the test dataset</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Data/test_data.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Data/data.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define features and target</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;temp2_max(c)&quot;</span><span class="p">,</span> <span class="s2">&quot;temp2_min(c)&quot;</span><span class="p">,</span> <span class="s2">&quot;temp2_ave(c)&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;suface_pressure(pa)&quot;</span><span class="p">,</span> <span class="s2">&quot;wind_speed50_max(m/s)&quot;</span><span class="p">,</span> <span class="s2">&quot;wind_speed50_min(m/s)&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;wind_speed50_ave(m/s)&quot;</span><span class="p">,</span> <span class="s2">&quot;prectotcorr&quot;</span><span class="p">,</span> <span class="s2">&quot;total_demand(mw)&quot;</span>
<span class="p">]</span>

<span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;max_generation(mw)&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test data shape: </span><span class="si">{</span><span class="n">test_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full data shape: </span><span class="si">{</span><span class="n">full_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test period: </span><span class="si">{</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="step-2-load-trained-models-and-scalers">
<h2>Step 2: Load Trained Models and Scalers<a class="headerlink" href="#step-2-load-trained-models-and-scalers" title="Permalink to this heading"></a></h2>
<section id="load-main-model">
<h3>Load Main Model<a class="headerlink" href="#load-main-model" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the main energy generation model</span>
<span class="n">model_path</span> <span class="o">=</span> <span class="s2">&quot;models/final_model_291.19.h5&quot;</span>
<span class="n">main_model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mse&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Main model loaded successfully&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">main_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="load-scalers">
<h3>Load Scalers<a class="headerlink" href="#load-scalers" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the fitted scalers</span>
<span class="n">scaler_X</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;scalers/X_train_scaler.pkl&quot;</span><span class="p">)</span>
<span class="n">scaler_y</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;scalers/y_train_scaler.pkl&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scalers loaded successfully&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature scaler range: </span><span class="si">{</span><span class="n">scaler_X</span><span class="o">.</span><span class="n">data_min_</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">scaler_X</span><span class="o">.</span><span class="n">data_max_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="load-individual-feature-models">
<h3>Load Individual Feature Models<a class="headerlink" href="#load-individual-feature-models" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span><span class="w"> </span><span class="nf">load_feature_models</span><span class="p">(</span><span class="n">models_dir</span><span class="o">=</span><span class="s2">&quot;models&quot;</span><span class="p">,</span> <span class="n">scalers_dir</span><span class="o">=</span><span class="s2">&quot;scalers&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load all individual feature models and their scalers&quot;&quot;&quot;</span>
    
    <span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">scalers</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># List of individual features with models</span>
    <span class="n">feature_files</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;temp2_max(c)&quot;</span><span class="p">,</span> <span class="s2">&quot;temp2_min(c)&quot;</span><span class="p">,</span> <span class="s2">&quot;temp2_ave(c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;suface_pressure(pa)&quot;</span><span class="p">,</span> <span class="s2">&quot;wind_speed50_max(ms)&quot;</span><span class="p">,</span> <span class="s2">&quot;wind_speed50_min(ms)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wind_speed50_ave(ms)&quot;</span><span class="p">,</span> <span class="s2">&quot;prectotcorr&quot;</span><span class="p">,</span> <span class="s2">&quot;total_demand(mw)&quot;</span>
    <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">feature_files</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Load model</span>
            <span class="n">model_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">_LSTM.h5&quot;</span>
            <span class="n">model_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">models_dir</span><span class="p">,</span> <span class="n">model_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_path</span><span class="p">):</span>
                <span class="n">models</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mse&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">})</span>
                
            <span class="c1"># Load scaler</span>
            <span class="n">scaler_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">_scaler.pkl&quot;</span>
            <span class="n">scaler_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scalers_dir</span><span class="p">,</span> <span class="n">scaler_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">scaler_path</span><span class="p">):</span>
                <span class="n">scalers</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">scaler_path</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not load </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s2"> individual models&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">scalers</span><span class="p">)</span><span class="si">}</span><span class="s2"> individual scalers&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">models</span><span class="p">,</span> <span class="n">scalers</span>

<span class="c1"># Load individual models and scalers</span>
<span class="n">individual_models</span><span class="p">,</span> <span class="n">individual_scalers</span> <span class="o">=</span> <span class="n">load_feature_models</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="step-3-single-step-prediction">
<h2>Step 3: Single-Step Prediction<a class="headerlink" href="#step-3-single-step-prediction" title="Permalink to this heading"></a></h2>
<section id="prepare-input-data">
<h3>Prepare Input Data<a class="headerlink" href="#prepare-input-data" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">scaler_X</span><span class="p">,</span> <span class="n">n_input</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare input data for LSTM prediction</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        Input data</span>
<span class="sd">    features : list</span>
<span class="sd">        List of feature column names</span>
<span class="sd">    scaler_X : sklearn scaler</span>
<span class="sd">        Fitted feature scaler</span>
<span class="sd">    n_input : int</span>
<span class="sd">        Sequence length for LSTM</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.array</span>
<span class="sd">        Scaled and reshaped data ready for LSTM input</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract features</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Scale features</span>
    <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="c1"># Reshape for LSTM input</span>
    <span class="n">X_reshaped</span> <span class="o">=</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_input</span><span class="p">,</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    
    <span class="k">return</span> <span class="n">X_reshaped</span><span class="p">,</span> <span class="n">X_scaled</span>

<span class="c1"># Prepare test data</span>
<span class="n">X_test_reshaped</span><span class="p">,</span> <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">prepare_input_data</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">scaler_X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prepared input shape: </span><span class="si">{</span><span class="n">X_test_reshaped</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="make-single-predictions">
<h3>Make Single Predictions<a class="headerlink" href="#make-single-predictions" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_single_predictions</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_input</span><span class="p">,</span> <span class="n">scaler_y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make single-step predictions</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    model : tensorflow.keras.Model</span>
<span class="sd">        Trained LSTM model</span>
<span class="sd">    X_input : np.array</span>
<span class="sd">        Prepared input data</span>
<span class="sd">    scaler_y : sklearn scaler</span>
<span class="sd">        Fitted target scaler</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.array</span>
<span class="sd">        Predictions in original scale</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make predictions</span>
    <span class="n">y_pred_scaled</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_input</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># Inverse transform to original scale</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred_scaled</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># Make predictions on test data</span>
<span class="n">test_predictions</span> <span class="o">=</span> <span class="n">make_single_predictions</span><span class="p">(</span><span class="n">main_model</span><span class="p">,</span> <span class="n">X_test_reshaped</span><span class="p">,</span> <span class="n">scaler_y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_predictions</span><span class="p">)</span><span class="si">}</span><span class="s2"> predictions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction range: </span><span class="si">{</span><span class="n">test_predictions</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">test_predictions</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="evaluate-single-predictions">
<h3>Evaluate Single Predictions<a class="headerlink" href="#evaluate-single-predictions" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate performance metrics</span>
<span class="n">y_test_actual</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_actual</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_actual</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test_actual</span> <span class="o">-</span> <span class="n">test_predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test_actual</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Single-Step Prediction Performance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># R-squared</span>
<span class="n">r2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_test_actual</span> <span class="o">-</span> <span class="n">test_predictions</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> 
          <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_test_actual</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_test_actual</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="step-4-multi-step-forecasting-365-days">
<h2>Step 4: Multi-Step Forecasting (365 Days)<a class="headerlink" href="#step-4-multi-step-forecasting-365-days" title="Permalink to this heading"></a></h2>
<section id="implement-future-prediction-function">
<h3>Implement Future Prediction Function<a class="headerlink" href="#implement-future-prediction-function" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict_future_days</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">last_data</span><span class="p">,</span> <span class="n">scaler_X</span><span class="p">,</span> <span class="n">scaler_y</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">n_days</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> <span class="n">n_input</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict future values for specified number of days</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    model : tensorflow.keras.Model</span>
<span class="sd">        Trained LSTM model</span>
<span class="sd">    last_data : pd.DataFrame</span>
<span class="sd">        Last known data points</span>
<span class="sd">    scaler_X : sklearn scaler</span>
<span class="sd">        Feature scaler</span>
<span class="sd">    scaler_y : sklearn scaler</span>
<span class="sd">        Target scaler</span>
<span class="sd">    features : list</span>
<span class="sd">        Feature column names</span>
<span class="sd">    n_days : int</span>
<span class="sd">        Number of days to predict</span>
<span class="sd">    n_input : int</span>
<span class="sd">        Sequence length</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    list</span>
<span class="sd">        Future predictions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Get last values for features</span>
    <span class="n">last_values</span> <span class="o">=</span> <span class="n">last_data</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">n_input</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_days</span><span class="p">):</span>
        <span class="c1"># Scale the input</span>
        <span class="n">scaled_input</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">last_values</span><span class="p">)</span>
        <span class="n">reshaped_input</span> <span class="o">=</span> <span class="n">scaled_input</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_input</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)))</span>
        
        <span class="c1"># Make prediction</span>
        <span class="n">scaled_prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">reshaped_input</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">scaled_prediction</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
        
        <span class="c1"># Update input for next prediction (simple approach - use last known values)</span>
        <span class="c1"># In practice, you might want to predict features as well</span>
        <span class="n">last_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">last_values</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">last_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_values</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Use previous values as approximation</span>
    
    <span class="k">return</span> <span class="n">predictions</span>

<span class="c1"># Make 365-day predictions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating 365-day forecast...&quot;</span><span class="p">)</span>
<span class="n">future_predictions</span> <span class="o">=</span> <span class="n">predict_future_days</span><span class="p">(</span>
    <span class="n">main_model</span><span class="p">,</span> 
    <span class="n">full_data</span><span class="p">,</span> 
    <span class="n">scaler_X</span><span class="p">,</span> 
    <span class="n">scaler_y</span><span class="p">,</span> 
    <span class="n">features</span><span class="p">,</span> 
    <span class="n">n_days</span><span class="o">=</span><span class="mi">365</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">future_predictions</span><span class="p">)</span><span class="si">}</span><span class="s2"> future predictions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Future prediction range: </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">future_predictions</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">future_predictions</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-future-dates">
<h3>Create Future Dates<a class="headerlink" href="#create-future-dates" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create future date index</span>
<span class="n">last_date</span> <span class="o">=</span> <span class="n">full_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">future_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
    <span class="n">start</span><span class="o">=</span><span class="n">last_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
    <span class="n">periods</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> 
    <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span>
<span class="p">)</span>

<span class="c1"># Create future predictions DataFrame</span>
<span class="n">future_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;predicted_generation&#39;</span><span class="p">:</span> <span class="n">future_predictions</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">future_dates</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Future predictions period: </span><span class="si">{</span><span class="n">future_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">future_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="step-5-ensemble-predictions-with-individual-models">
<h2>Step 5: Ensemble Predictions with Individual Models<a class="headerlink" href="#step-5-ensemble-predictions-with-individual-models" title="Permalink to this heading"></a></h2>
<section id="predict-individual-features-for-future">
<h3>Predict Individual Features for Future<a class="headerlink" href="#predict-individual-features-for-future" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict_individual_features</span><span class="p">(</span><span class="n">individual_models</span><span class="p">,</span> <span class="n">individual_scalers</span><span class="p">,</span> <span class="n">last_data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">n_days</span><span class="o">=</span><span class="mi">365</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict individual features using their specific models</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    individual_models : dict</span>
<span class="sd">        Dictionary of individual feature models</span>
<span class="sd">    individual_scalers : dict</span>
<span class="sd">        Dictionary of individual feature scalers</span>
<span class="sd">    last_data : pd.DataFrame</span>
<span class="sd">        Last known data</span>
<span class="sd">    features : list</span>
<span class="sd">        Feature names</span>
<span class="sd">    n_days : int</span>
<span class="sd">        Number of days to predict</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        DataFrame with predicted features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">feature_predictions</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
        <span class="c1"># Map feature names to file names</span>
        <span class="n">feature_key</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;(m/s)&#39;</span> <span class="ow">in</span> <span class="n">feature</span><span class="p">:</span>
            <span class="n">feature_key</span> <span class="o">=</span> <span class="n">feature_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(m/s)&#39;</span><span class="p">,</span> <span class="s1">&#39;(ms)&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">feature_key</span> <span class="ow">in</span> <span class="n">individual_models</span> <span class="ow">and</span> <span class="n">feature_key</span> <span class="ow">in</span> <span class="n">individual_scalers</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">individual_models</span><span class="p">[</span><span class="n">feature_key</span><span class="p">]</span>
                <span class="n">scaler</span> <span class="o">=</span> <span class="n">individual_scalers</span><span class="p">[</span><span class="n">feature_key</span><span class="p">]</span>
                
                <span class="c1"># Get last values for this feature</span>
                <span class="n">last_values</span> <span class="o">=</span> <span class="n">last_data</span><span class="p">[[</span><span class="n">feature</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>
                
                <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_days</span><span class="p">):</span>
                    <span class="c1"># Scale input</span>
                    <span class="n">scaled_input</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">last_values</span><span class="p">)</span>
                    <span class="n">reshaped_input</span> <span class="o">=</span> <span class="n">scaled_input</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                    
                    <span class="c1"># Predict</span>
                    <span class="n">scaled_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">reshaped_input</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">pred</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">scaled_pred</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    
                    <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
                    
                    <span class="c1"># Update for next prediction</span>
                    <span class="n">last_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">pred</span><span class="p">]])</span>
                
                <span class="n">feature_predictions</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="si">}</span><span class="s2"> values&quot;</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not predict </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># Use simple extrapolation as fallback</span>
                <span class="n">last_value</span> <span class="o">=</span> <span class="n">last_data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">feature_predictions</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">last_value</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_days</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use simple extrapolation for missing models</span>
            <span class="n">last_value</span> <span class="o">=</span> <span class="n">last_data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">feature_predictions</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">last_value</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_days</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feature_predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">future_dates</span><span class="p">)</span>

<span class="c1"># Predict individual features</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicting individual features...&quot;</span><span class="p">)</span>
<span class="n">future_features</span> <span class="o">=</span> <span class="n">predict_individual_features</span><span class="p">(</span>
    <span class="n">individual_models</span><span class="p">,</span> 
    <span class="n">individual_scalers</span><span class="p">,</span> 
    <span class="n">full_data</span><span class="p">,</span> 
    <span class="n">features</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted features shape: </span><span class="si">{</span><span class="n">future_features</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ensemble-prediction">
<h3>Ensemble Prediction<a class="headerlink" href="#ensemble-prediction" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ensemble_prediction</span><span class="p">(</span><span class="n">main_model</span><span class="p">,</span> <span class="n">future_features</span><span class="p">,</span> <span class="n">scaler_X</span><span class="p">,</span> <span class="n">scaler_y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make ensemble predictions using predicted features</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    main_model : tensorflow.keras.Model</span>
<span class="sd">        Main LSTM model</span>
<span class="sd">    future_features : pd.DataFrame</span>
<span class="sd">        Predicted feature values</span>
<span class="sd">    scaler_X : sklearn scaler</span>
<span class="sd">        Feature scaler</span>
<span class="sd">    scaler_y : sklearn scaler</span>
<span class="sd">        Target scaler</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.array</span>
<span class="sd">        Ensemble predictions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prepare features</span>
    <span class="n">X_future</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">prepare_input_data</span><span class="p">(</span><span class="n">future_features</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">scaler_X</span><span class="p">)</span>
    
    <span class="c1"># Make predictions</span>
    <span class="n">ensemble_preds</span> <span class="o">=</span> <span class="n">make_single_predictions</span><span class="p">(</span><span class="n">main_model</span><span class="p">,</span> <span class="n">X_future</span><span class="p">,</span> <span class="n">scaler_y</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ensemble_preds</span>

<span class="c1"># Make ensemble predictions</span>
<span class="n">ensemble_predictions</span> <span class="o">=</span> <span class="n">ensemble_prediction</span><span class="p">(</span><span class="n">main_model</span><span class="p">,</span> <span class="n">future_features</span><span class="p">,</span> <span class="n">scaler_X</span><span class="p">,</span> <span class="n">scaler_y</span><span class="p">)</span>

<span class="c1"># Add to future DataFrame</span>
<span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ensemble_predictions</span>
<span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;simple_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">future_predictions</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble predictions completed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="step-6-prediction-confidence-intervals">
<h2>Step 6: Prediction Confidence Intervals<a class="headerlink" href="#step-6-prediction-confidence-intervals" title="Permalink to this heading"></a></h2>
<section id="calculate-prediction-uncertainty">
<h3>Calculate Prediction Uncertainty<a class="headerlink" href="#calculate-prediction-uncertainty" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_prediction_intervals</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate prediction intervals based on historical prediction errors</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    predictions : np.array</span>
<span class="sd">        Point predictions</span>
<span class="sd">    confidence : float</span>
<span class="sd">        Confidence level (e.g., 0.95 for 95% confidence)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    tuple</span>
<span class="sd">        (lower_bound, upper_bound)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate prediction errors from test set</span>
    <span class="n">test_errors</span> <span class="o">=</span> <span class="n">y_test_actual</span> <span class="o">-</span> <span class="n">test_predictions</span>
    
    <span class="c1"># Calculate standard deviation of errors</span>
    <span class="n">error_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">test_errors</span><span class="p">)</span>
    
    <span class="c1"># Calculate confidence intervals</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence</span>
    <span class="n">z_score</span> <span class="o">=</span> <span class="mf">1.96</span>  <span class="c1"># For 95% confidence interval</span>
    
    <span class="n">margin_of_error</span> <span class="o">=</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">error_std</span>
    
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">-</span> <span class="n">margin_of_error</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">+</span> <span class="n">margin_of_error</span>
    
    <span class="k">return</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">calculate_prediction_intervals</span><span class="p">(</span><span class="n">ensemble_predictions</span><span class="p">)</span>

<span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower_bound</span>
<span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;upper_bound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper_bound</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence intervals calculated with ±</span><span class="si">{</span><span class="n">upper_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ensemble_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW margin&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="step-7-visualization-and-analysis">
<h2>Step 7: Visualization and Analysis<a class="headerlink" href="#step-7-visualization-and-analysis" title="Permalink to this heading"></a></h2>
<section id="plot-predictions">
<h3>Plot Predictions<a class="headerlink" href="#plot-predictions" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_predictions</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="n">future_predictions</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_preds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create comprehensive prediction visualization</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    historical_data : pd.DataFrame</span>
<span class="sd">        Historical data</span>
<span class="sd">    future_predictions : pd.DataFrame</span>
<span class="sd">        Future predictions with confidence intervals</span>
<span class="sd">    test_data : pd.DataFrame, optional</span>
<span class="sd">        Test data for validation</span>
<span class="sd">    test_preds : np.array, optional</span>
<span class="sd">        Test predictions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    
    <span class="c1"># Plot 1: Historical + Future predictions</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Historical data (last 2 years)</span>
    <span class="n">recent_data</span> <span class="o">=</span> <span class="n">historical_data</span><span class="o">.</span><span class="n">last</span><span class="p">(</span><span class="s1">&#39;730D&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recent_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">recent_data</span><span class="p">[</span><span class="n">target</span><span class="p">],</span> 
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Historical&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    
    <span class="c1"># Future predictions</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">future_predictions</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">future_predictions</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">],</span> 
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Future Prediction&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Confidence intervals</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">future_predictions</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> 
                     <span class="n">future_predictions</span><span class="p">[</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">],</span>
                     <span class="n">future_predictions</span><span class="p">[</span><span class="s1">&#39;upper_bound&#39;</span><span class="p">],</span>
                     <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Confidence Interval&#39;</span><span class="p">)</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Energy Generation: Historical Data and Future Predictions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Max Generation (MW)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="c1"># Plot 2: Test data validation (if provided)</span>
    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">test_preds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="n">target</span><span class="p">],</span> 
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_preds</span><span class="p">,</span> 
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Model Validation on Test Data&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Max Generation (MW)&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create visualization</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">full_data</span><span class="p">,</span> <span class="n">future_df</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="seasonal-analysis">
<h3>Seasonal Analysis<a class="headerlink" href="#seasonal-analysis" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_seasonal_patterns</span><span class="p">(</span><span class="n">future_predictions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyze seasonal patterns in predictions</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    future_predictions : pd.DataFrame</span>
<span class="sd">        Future predictions with date index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Add temporal features</span>
    <span class="n">df_analysis</span> <span class="o">=</span> <span class="n">future_predictions</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df_analysis</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_analysis</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df_analysis</span><span class="p">[</span><span class="s1">&#39;quarter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_analysis</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">quarter</span>
    <span class="n">df_analysis</span><span class="p">[</span><span class="s1">&#39;day_of_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_analysis</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
    
    <span class="c1"># Monthly averages</span>
    <span class="n">monthly_avg</span> <span class="o">=</span> <span class="n">df_analysis</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># Quarterly averages</span>
    <span class="n">quarterly_avg</span> <span class="o">=</span> <span class="n">df_analysis</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;quarter&#39;</span><span class="p">)[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># Plot seasonal patterns</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    
    <span class="c1"># Monthly pattern</span>
    <span class="n">monthly_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Predicted Average Generation by Month&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Average Generation (MW)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="c1"># Quarterly pattern</span>
    <span class="n">quarterly_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Predicted Average Generation by Quarter&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Quarter&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Average Generation (MW)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">monthly_avg</span><span class="p">,</span> <span class="n">quarterly_avg</span>

<span class="c1"># Analyze seasonal patterns</span>
<span class="n">monthly_patterns</span><span class="p">,</span> <span class="n">quarterly_patterns</span> <span class="o">=</span> <span class="n">analyze_seasonal_patterns</span><span class="p">(</span><span class="n">future_df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Seasonal Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Monthly Averages:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="n">monthly_patterns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Month </span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Quarterly Averages:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="n">quarterly_patterns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">quarter</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="feature-importance-analysis">
<h3>Feature Importance Analysis<a class="headerlink" href="#feature-importance-analysis" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_predicted_features</span><span class="p">(</span><span class="n">future_features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyze the predicted features</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    future_features : pd.DataFrame</span>
<span class="sd">        Predicted features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Calculate correlations between predicted features and generation</span>
    <span class="n">correlations</span> <span class="o">=</span> <span class="n">future_features</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">])</span>
    
    <span class="c1"># Plot correlations</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">correlations</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Feature Correlations with Predicted Generation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute Correlation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">correlations</span>

<span class="c1"># Analyze feature correlations</span>
<span class="n">feature_correlations</span> <span class="o">=</span> <span class="n">analyze_predicted_features</span><span class="p">(</span><span class="n">future_features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Feature Correlations with Predicted Generation:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">corr</span> <span class="ow">in</span> <span class="n">feature_correlations</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="step-8-export-results">
<h2>Step 8: Export Results<a class="headerlink" href="#step-8-export-results" title="Permalink to this heading"></a></h2>
<section id="save-predictions">
<h3>Save Predictions<a class="headerlink" href="#save-predictions" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">export_predictions</span><span class="p">(</span><span class="n">future_df</span><span class="p">,</span> <span class="n">future_features</span><span class="p">,</span> <span class="n">filename_prefix</span><span class="o">=</span><span class="s2">&quot;predictions&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export predictions to various formats</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    future_df : pd.DataFrame</span>
<span class="sd">        Future predictions</span>
<span class="sd">    future_features : pd.DataFrame</span>
<span class="sd">        Predicted features</span>
<span class="sd">    filename_prefix : str</span>
<span class="sd">        Prefix for output files</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Create results directory</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Export main predictions</span>
    <span class="n">future_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_generation.csv&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generation predictions saved to results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_generation.csv&quot;</span><span class="p">)</span>
    
    <span class="c1"># Export predicted features</span>
    <span class="n">future_features</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_features.csv&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature predictions saved to results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_features.csv&quot;</span><span class="p">)</span>
    
    <span class="c1"># Export combined results</span>
    <span class="n">combined_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">future_features</span><span class="p">,</span> <span class="n">future_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">combined_results</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_combined.csv&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined results saved to results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_combined.csv&quot;</span><span class="p">)</span>
    
    <span class="c1"># Export summary statistics</span>
    <span class="n">summary_stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;prediction_period&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">future_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">future_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">())],</span>
        <span class="s1">&#39;total_predictions&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">future_df</span><span class="p">),</span>
        <span class="s1">&#39;average_generation&#39;</span><span class="p">:</span> <span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;min_generation&#39;</span><span class="p">:</span> <span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="s1">&#39;max_generation&#39;</span><span class="p">:</span> <span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="s1">&#39;std_generation&#39;</span><span class="p">:</span> <span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
        <span class="s1">&#39;confidence_interval_width&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;upper_bound&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_summary.json&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">summary_stats</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Summary statistics saved to results/</span><span class="si">{</span><span class="n">filename_prefix</span><span class="si">}</span><span class="s2">_summary.json&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">combined_results</span>

<span class="c1"># Export all results</span>
<span class="n">combined_results</span> <span class="o">=</span> <span class="n">export_predictions</span><span class="p">(</span><span class="n">future_df</span><span class="p">,</span> <span class="n">future_features</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-prediction-report">
<h3>Create Prediction Report<a class="headerlink" href="#create-prediction-report" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_prediction_report</span><span class="p">(</span><span class="n">future_df</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a comprehensive prediction report</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    future_df : pd.DataFrame</span>
<span class="sd">        Future predictions</span>
<span class="sd">    test_metrics : dict</span>
<span class="sd">        Test performance metrics</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">report</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">ENERGY GENERATION PREDICTION REPORT</span>
<span class="s2">=====================================</span>

<span class="s2">PREDICTION OVERVIEW:</span>
<span class="s2">- Prediction Period: </span><span class="si">{</span><span class="n">future_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">future_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">- Total Days Predicted: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">future_df</span><span class="p">)</span><span class="si">}</span>
<span class="s2">- Model Type: LSTM Neural Network</span>

<span class="s2">PREDICTION STATISTICS:</span>
<span class="s2">- Average Generation: </span><span class="si">{</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>
<span class="s2">- Minimum Generation: </span><span class="si">{</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>
<span class="s2">- Maximum Generation: </span><span class="si">{</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>
<span class="s2">- Standard Deviation: </span><span class="si">{</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;ensemble_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>

<span class="s2">CONFIDENCE INTERVALS:</span>
<span class="s2">- Confidence Level: 95%</span>
<span class="s2">- Average Interval Width: </span><span class="si">{</span><span class="p">(</span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;upper_bound&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">future_df</span><span class="p">[</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>

<span class="s2">MODEL VALIDATION PERFORMANCE:</span>
<span class="s2">- RMSE: </span><span class="si">{</span><span class="n">test_metrics</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>
<span class="s2">- MAE: </span><span class="si">{</span><span class="n">test_metrics</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>
<span class="s2">- MAPE: </span><span class="si">{</span><span class="n">test_metrics</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%</span>
<span class="s2">- R²: </span><span class="si">{</span><span class="n">test_metrics</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span>

<span class="s2">SEASONAL PATTERNS:</span>
<span class="s2">- Highest Predicted Month: Month </span><span class="si">{</span><span class="n">monthly_patterns</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">monthly_patterns</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW)</span>
<span class="s2">- Lowest Predicted Month: Month </span><span class="si">{</span><span class="n">monthly_patterns</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">monthly_patterns</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW)</span>
<span class="s2">- Seasonal Variation: </span><span class="si">{</span><span class="p">(</span><span class="n">monthly_patterns</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">monthly_patterns</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW</span>

<span class="s2">RECOMMENDATIONS:</span>
<span class="s2">1. Monitor actual vs predicted values for model recalibration</span>
<span class="s2">2. Consider weather forecast integration for improved accuracy</span>
<span class="s2">3. Update model quarterly with new data</span>
<span class="s2">4. Validate predictions against domain expertise</span>

<span class="s2">Report Generated: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">&quot;&quot;&quot;</span>
    
    <span class="c1"># Save report</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;results/prediction_report.txt&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction report saved to results/prediction_report.txt&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

<span class="c1"># Create prediction report</span>
<span class="n">test_metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
    <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
    <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
    <span class="s1">&#39;r2&#39;</span><span class="p">:</span> <span class="n">r2</span>
<span class="p">}</span>

<span class="n">create_prediction_report</span><span class="p">(</span><span class="n">future_df</span><span class="p">,</span> <span class="n">test_metrics</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices-for-predictions">
<h2>Best Practices for Predictions<a class="headerlink" href="#best-practices-for-predictions" title="Permalink to this heading"></a></h2>
<section id="model-maintenance">
<h3>Model Maintenance<a class="headerlink" href="#model-maintenance" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Regular Updates</strong>: Retrain models with new data quarterly</p></li>
<li><p><strong>Performance Monitoring</strong>: Track prediction accuracy over time</p></li>
<li><p><strong>Feature Drift</strong>: Monitor for changes in feature distributions</p></li>
<li><p><strong>Domain Validation</strong>: Validate predictions with energy experts</p></li>
</ol>
</section>
<section id="uncertainty-quantification">
<h3>Uncertainty Quantification<a class="headerlink" href="#uncertainty-quantification" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Confidence Intervals</strong>: Always provide uncertainty estimates</p></li>
<li><p><strong>Ensemble Methods</strong>: Use multiple models for robust predictions</p></li>
<li><p><strong>Scenario Analysis</strong>: Consider different prediction scenarios</p></li>
<li><p><strong>Error Analysis</strong>: Understand prediction limitations</p></li>
</ol>
</section>
<section id="practical-applications">
<h3>Practical Applications<a class="headerlink" href="#practical-applications" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Energy Planning</strong>: Use predictions for capacity planning</p></li>
<li><p><strong>Market Operations</strong>: Support energy trading decisions</p></li>
<li><p><strong>Grid Management</strong>: Assist in grid stability planning</p></li>
<li><p><strong>Investment Decisions</strong>: Inform renewable energy investments</p></li>
</ol>
<p>This tutorial provides a comprehensive framework for making reliable energy predictions using the trained LSTM models. The predictions can be used for strategic planning, operational decisions, and long-term energy management.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="model_training.html" class="btn btn-neutral float-left" title="Model Training Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../notebooks/data_preprocessing.html" class="btn btn-neutral float-right" title="Data Preprocessing Notebook" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Energy Analysis Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>